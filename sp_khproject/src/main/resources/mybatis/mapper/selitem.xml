<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="selItemMapper">
	<select id="getNextSeq" resultType="_int">
		SELECT SEL_ITEM_SEQ.NEXTVAL FROM DUAL
	</select>
	<!-- 오름차순으로 정렬 -->
	<select id="getData" resultType="selItemDto">
		<!-- SELECT * FROM SEL_ITEM ORDER BY SEL_ID DESC -->
		SELECT * FROM SEL_ITEM S FULL OUTER JOIN FILE_UPLOAD ON S.SEL_ID = FILE_BID ORDER BY SEL_ID DESC
	</select>

	<select id="selectData" resultType="selItemDto">
		SELECT * FROM SEL_ITEM  S FULL OUTER JOIN FILE_UPLOAD ON S.SEL_ID = FILE_BID WHERE SEL_FIELD = #{selectData} ORDER BY SEL_ID DESC
	</select>
	
	<select id="locationData" resultType="selItemDto">
		SELECT * FROM SEL_ITEM  S FULL OUTER JOIN FILE_UPLOAD ON S.SEL_ID = FILE_BID WHERE SEL_LOCATION = #{locationData} ORDER BY SEL_ID DESC
	</select>
	

	<insert id="insertData" parameterType="selItemDto" useGeneratedKeys="true"
        keyProperty="sel_id" keyColumn="SEL_ID">
	
		INSERT INTO SEL_ITEM(SEL_ID, SEL_NAME, SEL_FIELD, SEL_LOCATION, SEL_TITLE, SEL_CONTENT) 
		VALUES (SEL_ITEM_SEQ.NEXTVAL, #{sel_name}, #{sel_field}, #{sel_location}, #{sel_title}, #{sel_content})
	
	
	</insert>

	<select id="searchData" resultType="selItemDto">
		SELECT * FROM SEL_ITEM S FULL OUTER JOIN FILE_UPLOAD ON S.SEL_ID = FILE_BID WHERE (SEL_FIELD LIKE '%'||#{search}||'%' 
											OR SEL_NAME LIKE '%'||#{search}||'%'
											OR SEL_TITLE LIKE '%'||#{search}||'%') ORDER BY SEL_ID DESC
	</select>
	
	<select id="selectIdData" resultType="selItemDto">
		SELECT * FROM SEL_ITEM S FULL OUTER JOIN FILE_UPLOAD ON S.SEL_ID = FILE_BID WHERE SEL_ID = #{sel_id}
	</select>
	
	<select id="searchName" resultType="selItemDto">
		SELECT * FROM SEL_ITEM WHERE SEL_NAME = #{sel_name}
	</select>
	
	<update id="plusCount">
		UPDATE SEL_ITEM SET SEL_NUMBER = SEL_NUMBER + 1
		 WHERE SEL_ID = #{itemid}
	</update>

	<update id="updateData">
		UPDATE SEL_ITEM SET SEL_FIELD = #{sel_field} , SEL_TITLE = #{sel_title} ,
						    SEL_LOCATION = #{sel_location} , SEL_CONTENT = #{sel_content} ,
						    SEL_PRICE = #{sel_price}  WHERE SEL_ID = #{sel_id}
	</update>

	<update id="viewCnt">
		UPDATE SEL_ITEM SET SEL_VIEW = SEL_VIEW + 1
		 WHERE SEL_ID = #{sel_id}
	</update>

</mapper>